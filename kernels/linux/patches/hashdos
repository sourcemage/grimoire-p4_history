#!/bin/bash

DESCRIPTION="security fix for hash table DoS"
SHORT="security fix for hash table DoS"
HELP="Vulnerability: CAN-2003-0244
Several hash table implementations in the networking were remotely exploitable.  Remote attackers could launch attacks whereby, using carefully choosen forged source addresses, make every routing cache entry get hashed into the same hash chain.

Netfilter's IP conntrack module and the TCP syn-queue implementation had identical vulnerabilities and have been fixed too.

The choosen solution to the problem involved using Bob's Jenkins hash along with a randomly choosen input.  For the ipv4 routing cache we take things one step further and periodically choose a new random secret.  By default this happens every 10 minutes, but this is configurable by the user via sysctl knobs.

This patch is for 2.4.20
"
VERSIONS="2.4.20"

MD5S[0]=0a9d83f0fb0715c3cef97a66f86e9b69

if [[ "$1" == "CONFIG" ]]; then
echo "
SOURCE${COUNTER}='index.html?m=105217616607144\\&q=raw'
SOURCE${COUNTER}_URL='http://marc.theaimsgroup.com/?m=105217616607144\\&q=raw;FAKE=.tar.bz2'" >> ${SPELL_CONFIG}.DETAILS
source $SCRIPT_DIRECTORY/MD5PATCH
fi
