message "${MESSAGE_COLOR}Starting SVN checkout of"                                       \
        "${FILE_COLOR}${SOURCE}${MESSAGE_COLOR}...${DEFAULT_COLOR}"                      
if [[ -f $SOURCE_CACHE/${SOURCE} ]]
then
  message "${MESSAGE_COLOR}Previous source found unpacking...${DEFAULT_COLOR}"           
  tar -jxf $SOURCE_CACHE/${SOURCE}                                                       
  cd openwengo-svn                                                                       
  message "${MESSAGE_COLOR}Running SVN update...${DEFAULT_COLOR}"                        
#UPDATE
#LIBS
#update needed libraries
  mkdir -v -p libs
  cd libs
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/curl
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/ffmpeg
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/iconset
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/sound
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/trayicon
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/util
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/vcard
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/video
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/wengokeramik
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/zip
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/webcam
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/webcam_c
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/openssl
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/timer
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/portaudio
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/libs/global
  touch SConscript
  rm -f SConscript
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/libs/SConscript
  cd ..


#GUI

  mkdir -v -p softphone                                                                  
  cd softphone                                                                           
  mkdir -v -p trunk                                                                      
  cd trunk                                                                               
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/softphone/trunk/buildid               
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/softphone/trunk/gui                   
  touch SConscript SSoftphoneRuntime readme-fr.txt                                       \
        licence-fr.txt changelog-fr.txt COPYING SSoftphoneInstall                        
  rm -f SConscript SSoftphoneRuntime readme-fr.txt                                       \
        licence-fr.txt changelog-fr.txt COPYING SSoftphoneInstall                        
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SConscript     
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SSoftphoneRuntime 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/readme-fr.txt  
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/licence-fr.txt 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/changelog-fr.txt 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/COPYING        
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SSoftphoneInstall 
  cd ..                                                                                  
  cd ..                                                                                  

  #WIFO
  #     update  wifo
  mkdir -v -p wifo                                                                       
  cd wifo                                                                                
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/wifo/trunk                            
  cd ..                                                                                  

#     update    wengoscons & script dir
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/wengoscons                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/scons                                 
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      update                                                                             \
      http://dev.openwengo.com/svn/openwengo/script                                

#and finally download the main SConstruct file
  touch SConstruct                                                                       
  rm -f SConstruct                                                                       
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/SConstruct                     
  cd ..                                                                                  
  message "${MESSAGE_COLOR}Done...${DEFAULT_COLOR}"
else
  message "${MESSAGE_COLOR}Running initial SVN checkout...${DEFAULT_COLOR}"              &&

#CHECKOUT
#LIBS
#checkout needed libraries
  mkdir -v -p openwengo-svn                                                              
  cd openwengo-svn                                                                       
  mkdir -v -p libs                                                                       
  cd libs                                                                                
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/curl                             
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/ffmpeg                           
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/iconset                          
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/sound                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/trayicon                         
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/util                             
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/vcard                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/video                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/wengokeramik                     
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/zip                              
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/webcam                           
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/webcam_c                         
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/openssl                          
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/timer                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/portaudio                        
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/libs/global                           
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/libs/SConscript                
  cd ..                                                                                  


#GUI

  mkdir -v -p softphone                                                                  
  cd softphone                                                                           
  mkdir -v -p trunk                                                                      
  cd trunk                                                                               
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/softphone/trunk/buildid               
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/softphone/trunk/gui                   
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SConscript     
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SSoftphoneRuntime 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/readme-fr.txt  
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/licence-fr.txt 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/changelog-fr.txt 
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/COPYING        
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/softphone/trunk/SSoftphoneInstall 
  cd ..                                                                                  
  cd ..                                                                                  

  #WIFO
  #     checkout  wifo
  mkdir -v -p wifo                                                                       
  cd wifo                                                                                
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/wifo/trunk                            
  cd ..                                                                                  

#     checkout    wengoscons & script dir
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/wengoscons                            
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/scons                                 
  svn --username guest --password guest                                                  \
      --non-interactive                                                                  \
      checkout                                                                           \
      http://dev.openwengo.com/svn/openwengo/script                                

#and finally download the main SConstruct file
  wget http://guest:guest@dev.openwengo.com/svn/openwengo/SConstruct                     
  cd ..                                                                                  
  message "${MESSAGE_COLOR}Done...${DEFAULT_COLOR}"
fi                                                                                       

#Tarball generation

message "${MESSAGE_COLOR}Generating tarball...${DEFAULT_COLOR}"                          &&
tar -jcf                                                                                 \
    ${SOURCE}                                                                            \
    openwengo-svn                                                                        &&
cp  ${SOURCE} ${SOURCE_CACHE}/${SOURCE}                                                  &&
rm  ${SOURCE}                                                                            &&
message "${MESSAGE_COLOR}SVN Checkout complete...${DEFAULT_COLOR}"
