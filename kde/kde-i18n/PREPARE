           SPELL=kde-i18n
         VERSION=3.1
            SITE=\$KDE_URL/stable/3.1/src

# delete existing kde.languages, it has wrong URLs and format
rm $CONFIG_CACHE/kde.languages

get_kdelanguages()  {
  if ! [ -f $CONFIG_CACHE/kde.languages ]
  then
    touch $CONFIG_CACHE/kde.languages
    LANGUAGES=`cat $SCRIPT_DIRECTORY/kde.languages`
    LANGUAGES=`dialog  --backtitle  "KDE i18n Configuration Menu" \
                      --stdout                                   \
                      --title      "Select language please"      \
                      --checklist                                \
                      ""                                         \
                      0 50 10                                     \
                      $LANGUAGES`
    echo SITE=$SITE >> $CONFIG_CACHE/kde.languages
    echo MD5[0]=ignore >>$CONFIG_CACHE/kde.languages
    if [[ $LANGUAGES == ${LANGUAGES/ALL/} ]]
    then
      i=1
      for LANGUAGE in $LANGUAGES
      do
        LANGUAGE=${LANGUAGE:1:${#LANGUAGE}-2}
        if [[ $i == 1 ]]
        then
          echo SOURCE=\$SPELL-$LANGUAGE-\$VERSION.tar.bz2 >> $CONFIG_CACHE/kde.languages
          echo SOURCE_URL[0]=\$SITE/\$SPELL/\$SOURCE >>$CONFIG_CACHE/kde.languages
        else
          echo SOURCE$i=\$SPELL-$LANGUAGE-\$VERSION.tar.bz2 >> $CONFIG_CACHE/kde.languages >> $CONFIG_CACHE/kde.languages
          echo SOURCE${i}_URL[0]=\$SITE/\$SPELL/\$SOURCE$i >> $CONFIG_CACHE/kde.languages
        fi
        echo MD5[$i]=ignore >>$CONFIG_CACHE/kde.languages
        i=$[$i+1]
      done
    else
      echo SOURCE=\$SPELL-\$VERSION.tar.bz2 >> $CONFIG_CACHE/kde.languages
      echo SOURCE_URL[0]=\$SITE/\$SOURCE >> $CONFIG_CACHE/kde.languages
    fi
  fi
  . $CONFIG_CACHE/kde.languages
}
get_kdelanguages
