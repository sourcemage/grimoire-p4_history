           SPELL=kde-i18n
         VERSION=3.1.2
            SITE=\$KDE_URL/stable/3.1.2/src

# delete existing kde.languages, it has wrong URLs and format
if [ ! -s $SPELL_CONFIG ]
then rm $SPELL_CONFIG
fi

get_kdelanguages()  {
  if ! [ -f $SPELL_CONFIG ]
  then
    touch $SPELL_CONFIG
    LANGUAGES=`cat $SCRIPT_DIRECTORY/kde.languages`
    LANGUAGES=`dialog  --backtitle  "KDE i18n Configuration Menu" \
                      --stdout                                   \
                      --title      "Select language please"      \
                      --checklist                                \
                      ""                                         \
                      0 50 10                                     \
                      $LANGUAGES`
    echo SITE=$SITE >> $SPELL_CONFIG
    echo VERSION=$VERSION >> $SPELL_CONFIG
    echo MD5[0]=ignore >>$SPELL_CONFIG
    if [[ $LANGUAGES == ${LANGUAGES/ALL/} ]]
    then
      i=1
      for LANGUAGE in $LANGUAGES
      do
        LANGUAGE=${LANGUAGE:1:${#LANGUAGE}-2}
        if [[ $i == 1 ]]
        then
          echo SOURCE=\$SPELL-$LANGUAGE-\$VERSION.tar.bz2 >> $SPELL_CONFIG
          echo SOURCE_URL[0]=\$SITE/\$SPELL/\$SOURCE >>$SPELL_CONFIG
        else
          echo SOURCE$i=\$SPELL-$LANGUAGE-\$VERSION.tar.bz2 >> $SPELL_CONFIG >> $SPELL_CONFIG
          echo SOURCE${i}_URL[0]=\$SITE/\$SPELL/\$SOURCE$i >> $SPELL_CONFIG
        fi
        echo MD5[$i]=ignore >>$SPELL_CONFIG
        i=$[$i+1]
      done
    else
      echo SOURCE=\$SPELL-\$VERSION.tar.bz2 >> $SPELL_CONFIG
      echo SOURCE_URL[0]=\$SITE/\$SOURCE >> $SPELL_CONFIG
    fi
  fi
  . $SPELL_CONFIG
}
get_kdelanguages

