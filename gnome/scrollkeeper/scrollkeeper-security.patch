diff -uNr /home/spinkham/work/scrollkeeper/cl/src/get-cl.c ./cl/src/get-cl.c
--- /home/spinkham/work/scrollkeeper/cl/src/get-cl.c	2002-02-25 03:23:14.000000000 -0500
+++ ./cl/src/get-cl.c	2002-09-03 11:11:01.000000000 -0400
@@ -27,6 +27,7 @@
 #include <unistd.h>
 #include <sys/stat.h>
 #include <locale.h>
+#include <fcntl.h>
 
 /* cycles through five temporary filenames of the form /tmp/scrollkeeper-templfile.x,
    where x is number from 0 to 4 and returns the first one that does not exist or the
@@ -35,7 +36,7 @@
 static char *get_next_free_temp_file_path(char outputprefs)
 {
 	char path[PATHLEN], *filename;
-	int i, num;
+	int i, num, fd;
 	struct stat buf;
 	time_t prev;
 	
@@ -82,6 +83,17 @@
 	check_ptr(filename, "scrollkeeper-get-cl");
 	snprintf(filename, PATHLEN, "/tmp/scrollkeeper-tempfile.%d", num);
 
+	unlink(filename);
+	
+	fd = open(filename, O_RDWR | O_CREAT | O_EXCL | O_TRUNC | O_NONBLOCK,
+		  S_IRWXU | S_IRGRP | S_IROTH);
+
+	if (fd < 0) {
+	        fprintf (stderr, _("scrollkeeper-get-cl: Cannot open temp file: %s\n"), filename);
+		exit (EXIT_FAILURE);
+	}
+	close(fd);
+	
 	return filename;
 }
 
diff -uNr /home/spinkham/work/scrollkeeper/libs/extract.c ./libs/extract.c
--- /home/spinkham/work/scrollkeeper/libs/extract.c	2002-03-16 14:08:48.000000000 -0500
+++ ./libs/extract.c	2002-09-03 11:11:31.000000000 -0400
@@ -49,8 +49,8 @@
 	FILE *res_fid;
 	char *doctype;
 	char command[1024];
-	pid_t pid;
 	char temp1[PATHLEN], temp2[PATHLEN], errors[PATHLEN];
+	int temp1_fd, temp2_fd, errors_fd;
 #endif
 	struct stat buf;
 
@@ -69,11 +69,21 @@
 #ifdef SOLARIS
 		doc = docbParseFile(input_file, NULL);
 #else
-		pid = getpid();		
-		
-		snprintf(temp1, PATHLEN, "/var/tmp/scrollkeeper-extract-1-%ld.xml", (long)pid);
-		snprintf(temp2, PATHLEN, "/var/tmp/scrollkeeper-extract-2-%ld.xml", (long)pid);
-		snprintf(errors, PATHLEN, "/var/tmp/scrollkeeper-extract-errors-%ld", (long)pid);		
+		snprintf(temp1, PATHLEN, "/var/tmp/scrollkeeper-extract-1.xml.XXXXXX");
+		snprintf(temp2, PATHLEN, "/var/tmp/scrollkeeper-extract-2.xml.XXXXXX");
+		snprintf(errors, PATHLEN, "/var/tmp/scrollkeeper-extract-errors.XXXXXX");
+
+		temp1_fd = mkstemp(temp1);
+		printf ("%s\n", temp1);
+		if (temp1_fd == -1) {
+			return 0;
+		}
+		  
+		errors_fd = mkstemp(errors);
+		if (errors_fd == -1) {
+			return 0;
+		}
+		close(errors_fd);
 
 		snprintf(command, 1024, "sgml2xml -xlower -f%s %s > %s", errors, input_file, temp1);
 		system(command);
@@ -83,6 +93,7 @@
 		fid = fopen(input_file, "r");
 		if (fid == NULL) {
 			sk_message(outputprefs, SKOUT_DEFAULT, SKOUT_QUIET, "(apply_stylesheets)", _("Cannot read file: %s : %s\n"),input_file, strerror(errno));
+			close(temp1_fd);                        
 			return 0;
 		}
 
@@ -106,14 +117,24 @@
 		}
 		
 		if (doctype == NULL) {
+		        close(temp1_fd);
 			unlink(temp1);
 			return 0;		
 		}
-		
-		fid = fopen(temp1, "r");
-		res_fid = fopen(temp2, "w");
+
+		temp2_fd = mkstemp(temp2);
+		if (temp2_fd == -1) {
+		        close(temp1_fd);
+			unlink(temp1);
+			return 0;
+		}
+
+		fid = fdopen(temp1_fd, "r");
+		res_fid = fdopen(temp2_fd, "w");
 		if (fid == NULL || res_fid == NULL) {
+		        close(temp1_fd);
 			unlink(temp1);
+		        close(temp2_fd);
 			unlink(temp2);
 			return 0;
 		}
