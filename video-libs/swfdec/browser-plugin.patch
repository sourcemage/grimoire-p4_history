diff -Nur swfdec-0.3.5-orig/configure.ac swfdec-0.3.5/configure.ac
--- swfdec-0.3.5-orig/configure.ac	2005-05-20 21:08:38.000000000 +0200
+++ swfdec-0.3.5/configure.ac	2005-07-17 19:37:30.000000000 +0200
@@ -48,12 +48,6 @@
    AC_HELP_STRING([--with-pkg-config-path],[colon-separated list of pkg-config(1) dirs]),
    [export PKG_CONFIG_PATH=${withval}])
 
-ENABLE_MOZILLA_PLUGIN=auto
-AC_ARG_ENABLE(mozilla-plugin,
-  AC_HELP_STRING([--disable-mozilla-plugin],
-    [disable Mozilla plugin]),
-    [ENABLE_MOZILLA_PLUGIN=${enableval}])
-
 dnl Check for essential libraries first:
 dnl ====================================
 
@@ -145,22 +139,50 @@
   AC_DEFINE(HAVE_MAD, 1, [Define if mad is enabled])
 fi
 
-###
-### Check for Mozilla development headers
-###
-MOZILLA_CFLAGS=
-if test -z "$MOZILLA_CONFIG"; then
-  AC_PATH_PROG(MOZILLA_CONFIG, mozilla-config, no)
-fi
-if test "x$MOZILLA_CONFIG" != "xno"; then
-  _mozilla_include_dir=`$MOZILLA_CONFIG --cflags|sed 's/-I\(.*\) .*/\1/'`
-  MOZILLA_CFLAGS="-I$_mozilla_include_dir/plugin -I$_mozilla_include_dir/java -I$_mozilla_include_dir/nspr"
-  HAVE_MOZILLA=yes
+dnl ******************
+dnl Mozilla name check
+dnl ******************
+
+AC_MSG_CHECKING([which mozilla to use])
+
+MOZILLA=
+AC_ARG_WITH([mozilla],
+	AS_HELP_STRING([--with-mozilla@<:@=mozilla|firefox@:>@],
+		       [Whether to build mozilla or firefox plugin (default: mozilla)]),
+	[MOZILLA="$withval"])
+
+dnl try to autodetect: if mozilla exists, use it, else try firefox, then thunderbird
+if test "x$MOZILLA" = "x"; then
+  if $PKG_CONFIG --exists mozilla-plugin; then
+    MOZILLA=mozilla
+  elif $PKG_CONFIG --exists firefox-plugin; then
+    MOZILLA=firefox
+  else
+    AC_MSG_WARN([no mozilla installation found. Mozilla/Netscape plugin will not be built])
+    HAVE_MOZILLA=no
+  fi
+elif test "x$with_mozilla" != "xmozilla" -a "x$with_mozilla" != "xfirefox" -a "x$with_mozilla" != "xno"; then
+  AC_MSG_ERROR([unknown mozilla name ($MOZILLA)])
+fi
+
+AC_SUBST(MOZILLA)
+
+AC_MSG_RESULT([$MOZILLA])
+
+if test "x$with_mozilla" != "xno"; then
+  PKG_CHECK_MODULES(MOZILLA_PLUGIN, $MOZILLA-plugin, HAVE_MOZILLA="yes", HAVE_MOZILLA="no")
+  AC_SUBST(MOZILLA_PLUGIN_CFLAGS)
+  AC_SUBST(MOZILLA_PLUGIN_LIBS)
+  if test "x$HAVE_MOZILLA" = "xyes"; then
+    MOZILLA_PLUGIN_DIR=`pkg-config --variable=libdir $MOZILLA-plugin`/plugins
+  else
+    MOZILLA_PLUGIN_DIR=
+  fi
 else
-  AC_MSG_WARN([mozilla-config not found. Mozilla/Netscape plugin will not be built])
+  MOZILLA_PLUGIN_DIR=
   HAVE_MOZILLA=no
 fi
-AC_SUBST(MOZILLA_CFLAGS)
+AC_SUBST(MOZILLA_PLUGIN_DIR)
 
 ###
 ### Check for GDK Pixbuf
@@ -236,15 +258,9 @@
 ### Makefile conditionals
 ###
 if test "${HAVE_GTK}" = "yes" -a "${HAVE_GST}" = "yes" -a "${HAVE_MOZILLA}" = "yes" ; then
-  if test "${ENABLE_MOZILLA_PLUGIN}" = "auto" ; then
-    ENABLE_MOZILLA_PLUGIN=yes
-  fi
+  ENABLE_MOZILLA_PLUGIN=yes
 else
-  if test "${ENABLE_MOZILLA_PLUGIN}" = "yes" ; then
-    AC_MSG_ERROR([Mozilla plugin enabled, but required packages not found])
-  else
-    ENABLE_MOZILLA_PLUGIN=no
-  fi
+  ENABLE_MOZILLA_PLUGIN=no
 fi
 AM_CONDITIONAL(ENABLE_MOZILLA_PLUGIN,[test "$ENABLE_MOZILLA_PLUGIN" = "yes"])
 
diff -Nur swfdec-0.3.5-orig/plugin/Makefile.am swfdec-0.3.5/plugin/Makefile.am
--- swfdec-0.3.5-orig/plugin/Makefile.am	2005-05-20 23:02:08.000000000 +0200
+++ swfdec-0.3.5/plugin/Makefile.am	2005-07-17 19:11:54.000000000 +0200
@@ -1,5 +1,5 @@
 
-plugindir = $(libdir)/mozilla/plugins/
+plugindir = @MOZILLA_PLUGIN_DIR@
 
 if ENABLE_MOZILLA_PLUGIN
 plugin_LTLIBRARIES = libswfdecmozilla.la
@@ -10,9 +10,9 @@
 endif
 
 libswfdecmozilla_la_SOURCES = plugin.c
-libswfdecmozilla_la_CFLAGS = $(SWF_CFLAGS) $(MOZILLA_CFLAGS) $(X_CFLAGS) \
+libswfdecmozilla_la_CFLAGS = $(SWF_CFLAGS) $(MOZILLA_PLUGIN_CFLAGS) $(X_CFLAGS) \
 	-DBINDIR=\"$(bindir)/\"
-libswfdecmozilla_la_LDFLAGS = -module -avoid-version $(X_LIBS)
+libswfdecmozilla_la_LDFLAGS = -module -avoid-version $(X_LIBS) $(MOZILLA_PLUGIN_LIBS)
 libswfdecmozilla_la_LIBADD = -lXt
 
 swfdec_mozilla_player_SOURCES = \
