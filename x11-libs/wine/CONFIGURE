# @usage configure_optional <1:test> <2:enable-option> <3:disable-option> <4:prompt> <5:hint>
# works right if <test> is part of both <enable-option> and <disable-option>
# @return 0 if disabled
function configure_optional() {
  if ! grep -q "${1#-}" $SPELL_CONFIG; then
    local OPTION="$2"
    query "$4" "$5" || OPTION="$3"
    echo "OPTS=\"\$OPTS $OPTION\"" >> $SPELL_CONFIG
  fi
  # return the `enabled' flag for the option
  grep -q "${2#--}" $SPELL_CONFIG
}

configure_optional      'debug'         '--enable-debug'        '--disable-debug'       'Compile in all debugging message?' n
configure_optional      'trace'         '--enable-trace'        '--disable-trace'       'Compile in TRACE messages?' n
configure_optional      'opengl'         '--with-opengl'        '--without-opengl'       'enable OpenGL support?' y
configure_optional      'win16'        '--enable-win16'      '--disable-win16'      'Include Win16 support?' y
configure_optional      'curses'         '--with-curses'        '--without-curses'       'use curses?' y

echo "OPTS=\"\$OPTS --with-x\"" >> $SPELL_CONFIG
