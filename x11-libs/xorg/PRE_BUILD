mk_source_dir  $SOURCE_DIRECTORY    &&
unpack  $SOURCE  ${MD5[0]}          &&
cp  $SOURCE_DIRECTORY/config/cf/xorgsite.def  \
    $SOURCE_DIRECTORY/config/cf/host.def      &&

if    [  -f  $CONFIG_CACHE/host.def  ]
then  cp     $CONFIG_CACHE/host.def                \
             $SOURCE_DIRECTORY/config/cf/host.def
fi  &&

if  !  grep  -q  InstallFontconfigLibrary  $SOURCE_DIRECTORY/config/cf/host.def
  then echo  "#define InstallFontconfigLibrary NO"     \
             >>  $SOURCE_DIRECTORY/config/cf/host.def
fi  &&

echo  "#define HasMotif NO"   >>  $SOURCE_DIRECTORY/config/cf/host.def  &&
echo  "#define HasMotif2 NO"  >>  $SOURCE_DIRECTORY/config/cf/host.def  &&

### fix the broken xcursor.pc file
#sedit  '/Requires/d'  $SOURCE_DIRECTORY/lib/Xcursor/xcursor.pc.in  &&

### removing -Os from copied host.def bug#3694 and cleaning up $CFLAGS
if  [  -f  $SOURCE_DIRECTORY/config/cf/host.def  ];  then
  # removing the -Os doesn't seem to be needed anymore on gcc 3.4.2,
  # please check on 3.3.x
  #sedit  s"/-Os//g"  $SOURCE_DIRECTORY/config/cf/host.def  &&

  #
  # Remove explicit PIC as well as that breaks the symbol logic in
  # /usr/X11R6/lib/modules/fonts/libbitmap.a:bitmapmod.o
  #
  sedit  s"/-DPIC -fPIC//g"  $SOURCE_DIRECTORY/config/cf/host.def
fi  &&

if  [  "$PAM"  ==  "y"  ];  then
  echo  "#define  HasPam  YES"  >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

#
# Let's give our OS name to X ;)
#
sedit  's:DefaultLinuxDistribution:LinuxSourceMage:'  \
       $SOURCE_DIRECTORY/config/cf/site.def           &&

#
# Now to define some of our user-specified settings
#
if  [  "$IPV6"  ==  "y"  ];  then
  echo  "#define  BuildIPv6   YES"  >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  spell_installed  groff;  then
  echo  "#define  HasGroff  YES"  >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  spell_installed  libpng;  then
  echo  "#define  HasLibpng  YES"  >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  [  "$XDEBUG"  == "n"  ]         ||
    (echo $LDFLAGS | grep -q -- "-s");  then
  echo  "#define  BuildDebug  NO"  >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  (echo $LDFLAGS | grep -q -- "-s");  then
  echo  "#define  StripInstalledPrograms  YES"  \
    >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  [  "$DEVELDRI"  ==  "y"  ];  then
  echo  "#define  BuildDevelDRIDrivers  YES"  \
    >>  $SOURCE_DIRECTORY/config/cf/site.def
fi  &&

if  [  "$JAPANESE"  ==  "y"  ];  then
  echo  "#define  InstallJapaneseDocs  YES"  \
    >>  $SOURCE_DIRECTORY/config/cf/site.def
fi
