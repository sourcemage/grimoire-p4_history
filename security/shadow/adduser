#!/bin/sh

if  [  "$UID"  ==  0  ];  then

  if  [  -z  "$1"  ];  then
    read  -p  "Username: "  NEWSER
  else
    NEWSER=$1
  fi

  [ -d ${INSTALL_ROOT}/home ] || mkdir ${INSTALL_ROOT}/home
  groupadd     $NEWSER
  useradd  -m  $NEWSER  -g  $NEWSER -s /bin/bash

  [ -d ${INSTALL_ROOT}/var/spool/mail ] || mkdir -p ${INSTALL_ROOT}/var/spool/mail
  touch                 ${INSTALL_ROOT}/var/spool/mail/$NEWSER
  chown   $NEWSER:mail  ${INSTALL_ROOT}/var/spool/mail/$NEWSER
  chmod   0660          ${INSTALL_ROOT}/var/spool/mail/$NEWSER
  passwd  $NEWSER

echo "default shell for $NEWSER has been set to /bin/bash. Edit /etc/passwd to change this"

else

  su  -  -c  "PATH=$PATH  $0  $1"

fi

