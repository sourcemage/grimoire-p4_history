(
  
 ./configure  --prefix=/usr		\
	      --sysconfdir=/etc/snort	\
	      ${CF_OPTS}		\
	      ${OPTS}			&&
 
 make					&&
 make  check				&&

 prepare_install			&&

 make  install

) >  $C_FIFO  2>&1  &&  (

  # Create the dirs
  echo making directory /etc/snort 	&&
  mkdir  -p  /etc/snort/rules		&&

  echo making directory /var/log/snort	&&
  mkdir  -p  /var/log/snort  		&&	

  chmod o-rwx /var/log/snort /etc/snort &&

  cd etc 				&&
  
  # copy config files
  for  FILE  in  `ls  *conf*`;  do
    if  [  !  -f  /etc/$FILE  ];  then
      echo installing etc/$FILE to /etc 			&&
      /usr/bin/install -c -m 640  $FILE  /etc/snort
    fi
  done 								&&

  cd ../rules 							&&

  for  FILE  in  `ls  *.rules`;  do
    if  [  !  -f  /etc/snort/$FILE  ];  then
      echo installing rules/$FILE to /etc/snort 		&&
      /usr/bin/install -c -m 640  $FILE   /etc/snort/rules
    fi
  done								&&

 # Modify the conf file
 sedit "s:../rules:/etc/snort/rules:" /etc/snort/snort.conf	&&


 # change owner and group
 chown snort.snort /etc/snort /var/log/snort -R			&&
 # to be sure ..
 chmod 640 /etc/snort/snort.conf
 
)
