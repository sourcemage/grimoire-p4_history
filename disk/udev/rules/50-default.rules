# allow automatic module loading in kernels >= 2.6.15
ENV{MODALIAS}=="?*",    RUN+="/sbin/modprobe $env{MODALIAS}"

# There are a number of modifiers that are allowed to be used in some of the
# fields.  See the udev man page for a full description of them.

# All block devices
SUBSYSTEM=="block",             GROUP="disk", MODE="0640"
SUBSYSTEM=="block", SYSFS{removable}=="1", GROUP="floppy"

# device mapper creates its own device nodes so ignore these
#KERNEL=="dm-[0-9]*", NAME=""
KERNEL=="device-mapper", NAME="mapper/control"

# Disk devices
KERNEL=="sd*",           NAME="%k", GROUP="disk"
KERNEL=="dasd*",         NAME="%k", GROUP="disk"
KERNEL=="ataraid*",      NAME="%k", GROUP="disk"
BUS=="scsi", KERNEL=="sr[0-9]*", GROUP="scsi"
BUS=="scsi", KERNEL=="sg[0-9]*", GROUP="burning"

# CDrom devices
BUS=="ide",     KERNEL=="hd[a-z]",  ACTION=="add", IMPORT="/sbin/cdrom_id --export $tempnode"
BUS=="scsi",    KERNEL=="sr[0-9]*", ACTION=="add", IMPORT="/sbin/cdrom_id --export $tempnode"
BUS=="scsi",    KERNEL=="scd[a-z]", ACTION=="add", IMPORT="/sbin/cdrom_id --export $tempnode"

ENV{ID_CDROM}=="?*",            SYMLINK+="cdrom%e", GROUP="cdrom"
ENV{ID_CDROM_CD_RW}=="?*",      SYMLINK+="cdrw%e", MODE="0660", GROUP="burning"
ENV{ID_CDROM_DVD}=="?*",        SYMLINK+="dvd%e"
ENV{ID_CDROM_DVD_R}=="?*",      SYMLINK+="dvdrw%e"

# permissions for SCSI CD devices
BUS=="scsi", KERNEL=="s[grt][0-9]*", SYSFS{type}=="5", MODE="0660", GROUP="cdrom"

# alsa devices
SUBSYSTEM=="sound", GROUP="audio", MODE="0660"
KERNEL=="controlC[0-9]*", NAME="snd/%k", RUN="/usr/sbin/alsactl restore"
KERNEL=="hw[CD0-9]*",     NAME="snd/%k"
KERNEL=="pcm[CD0-9cp]*",  NAME="snd/%k"
KERNEL=="midi[CD0-9]*",   NAME="snd/%k"
KERNEL=="timer",          NAME="snd/%k"
KERNEL=="seq",            NAME="snd/%k"

# sound devices
KERNEL=="admmidi"	NAME="sound/%k", SYMLINK="%k"
KERNEL=="adsp",		NAME="sound/%k", SYMLINK="%k"
KERNEL=="amidi"		NAME="sound/%k", SYMLINK="%k"
KERNEL=="adsp[0-9]*",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="audio",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="dmmidi"	NAME="sound/%k", SYMLINK="%k"
KERNEL=="audio[0-9]*",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="dsp",		NAME="sound/%k", SYMLINK="%k"
KERNEL=="dsp[0-9]*",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="mixer",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="mixer[0-9]*",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="sequencer",	NAME="sound/%k", SYMLINK="%k"
KERNEL=="sequencer[0-9]*", NAME="sound/%k", SYMLINK="%k"

# input devices
KERNEL=="mice",		NAME="input/%k", MODE="0644"
KERNEL=="mouse*",	NAME="input/%k", MODE="0644"
KERNEL=="event*",	NAME="input/%k", MODE="0644"
KERNEL=="js*",		NAME="input/%k", MODE="0644"
KERNEL=="ts*",		NAME="input/%k", MODE="0644"
KERNEL=="psaux"		NAME="input/%k", SYMLINK="%k", MODE="0644"

# misc devices
KERNEL=="console"	NAME="%k", MODE="0600"
KERNEL=="full",         NAME="%k", MODE="0666"
KERNEL=="kmem",         NAME="%k", MODE="0640"
KERNEL=="mem",          NAME="%k", MODE="0640"
KERNEL=="null",         NAME="%k", MODE="0666"
KERNEL=="port",         NAME="%k", MODE="0640"
KERNEL=="random",       NAME="%k", MODE="0644"
KERNEL=="rtc",		NAME="%k", MODE="0644"
KERNEL=="tty",		NAME="%k", MODE="0666"
KERNEL=="urandom",      NAME="%k", MODE="0644"
KERNEL=="zero",         NAME="%k", MODE="0666"

# needed to create ptys
KERNEL=="ptmx",		NAME="%k", MODE="0666"

# printer
KERNEL=="lp*",          NAME="%k", MODE="0660"
# HP printers
BUS=="usb", KERNEL=="lp[0-9]*", SYMLINK="usb%k"

# v4l devices
KERNEL=="video[0-9]*",  NAME="v4l/video%n", SYMLINK="video%n", GROUP="video", MODE="0660"
KERNEL=="radio[0-9]*",  NAME="v4l/radio%n", GROUP="video", MODE="0660"
KERNEL=="vbi[0-9]*",    NAME="v4l/vbi%n", SYMLINK="vbi%n", GROUP="video", MODE="0660"
KERNEL=="vtx[0-9]*",    NAME="v4l/vtx%n", GROUP="video", MODE="0660"

#nvidia devices
KERNEL=="nvidia*"	NAME="%k", MODE="0660", GROUP="video"

#framebuffer devices
KERNEL=="fb[0-9]",      NAME="%k", MODE="0660", GROUP="video"

# Network devices
KERNEL=="tun",          NAME="net/%k"

SUBSYSTEM=="firmware", ACTION="add", RUN+="/lib/udev/firmware_helper"

# be backward compatible for a while with the /etc/hotplug.d/ system
# run /etc/hotplug.d/ stuff only if we came from a hotplug event, not for udevstart
ENV{UDEVD_EVENT}=="1",  RUN="udev_run_hotplugd $env{SUBSYSTEM}"
