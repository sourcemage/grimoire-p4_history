install -d ${INSTALL_ROOT}/sys                &&
local file UDEV_CFG=${INSTALL_ROOT}/etc/udev  &&
mkdir  -p  ${UDEV_CFG}/rules.d                &&

install_config_file $SCRIPT_DIRECTORY/udev.conf ${UDEV_CFG}/udev.conf &&
install_config_file $SCRIPT_DIRECTORY/udev.missing ${UDEV_CFG}/udev.missing &&

for file in $SCRIPT_DIRECTORY/rules/* ; do
  install_config_file $file ${UDEV_CFG}/rules.d/$(basename $file)
done  &&

# install diff default rules on hotplug and non-hotplug systems
if spell_ok hotplug; then
  install_config_file $SCRIPT_DIRECTORY/50-default.rules-hotplug ${UDEV_CFG}/rules.d/50-default.rules
else
  install_config_file $SCRIPT_DIRECTORY/50-default.rules ${UDEV_CFG}/rules.d/50-default.rules
fi

# install alsa rules
install_config_file etc/udev/suse/40-alsa.rules ${UDEV_CFG}/rules.d/40-alsa.rules

# udevstart and udevsend are nolonger installed by default. we still need them
install udevsend udevstart  ${INSTALL_ROOT}/sbin &&

make prefix=${INSTALL_ROOT}/ exec_prefix=${INSTALL_ROOT}/ V=true ${OPTS} install   &&
make EXTRAS="extras/run_directory extras/cdrom_id extras/firmware" \
  prefix=${INSTALL_ROOT}/ exec_prefix=${INSTALL_ROOT}/ \
  V=true ${OPTS} install &&
if [[ "$UDEV_EXTRAS" == 'y' ]]; then
  make EXTRAS="extras/ata_id extras/dasd_id extras/edd_id extras/floppy extras/scsi_id extras/usb_id extras/volume_id" prefix=${INSTALL_ROOT}/ exec_prefix=${INSTALL_ROOT}/ ${OPTS} V=true install   &&
  install  extras/path_id/path_id  ${INSTALL_ROOT}/sbin  &&

  if [[ "$UDEV_PERSIST" == 'y' ]];then
    install_config_file etc/udev/60-persistent-storage.rules ${UDEV_CFG}/rules.d/60-persistent-storage.rules
  fi

fi  &&

# Install rules to set persistent name bindings for network interfaces
if [[ $UDEV_NETWORK == y ]]; then
  . $SCRIPT_DIRECTORY/bindings
fi  &&

if [[ "$UDEV_STATIC" == 'y' ]]; then
  pushd __static__ &&
  # we are not supposed to use `make install'
  local __FILE
  for __FILE in $UDEV_STATIC_TARGET; do
    install -D $__FILE $INSTALL_ROOT/usr/sbin/$__FILE.static
  done &&
  popd
fi
