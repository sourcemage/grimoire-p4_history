#!/bin/bash

PROGRAM=/bin/true
RUNLEVEL=DEV
ESSENTIAL=yes
NEEDS="devices udevd"

# source function library
. /etc/init.d/smgl_init


start() {
echo "starting coldplug"
        list=$(builtin echo /sys/bus/*/devices/*/uevent)
        list="$list $(builtin echo /sys/class/*/*/uevent)"
        list="$list $(builtin echo /sys/block/*/uevent /sys/block/*/*/uevent)"
        for i in $list; do
            case "$i" in
                */device/uevent|*\**)
                    continue
                    ;;
                */class/mem/*|*/class/tty/*)
                    first="$first $i"
                    ;;
                */block/md*)
                    last="$last $i"
                    ;;
                */*)
                    default="$default $i"
                    ;;
            esac
        done

        # trigger the sorted events
        for i in $first $default $last; do
            builtin echo "add" > "$i"
        done
echo "coldplug complete"
}
