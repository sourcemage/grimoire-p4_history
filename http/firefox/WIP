Needs testing (compiled on remote machine ;))
Should also implement Bug #7114
