local  FIREFOX_HOME                           &&
FIREFOX_HOME=${INSTALL_ROOT}/usr/lib/firefox  &&

if  spell_ok  Firebird;  then
  dispel Firebird
fi  &&

#
# Firefox now installs to /usr/lib/firefox and leaves /usr/lib/mozilla alone

mkdir  -p  $FIREFOX_HOME                                    &&
ln  -fns   $FIREFOX_HOME  $FIREFOX_HOME-$VERSION            &&
#mkdir  -p  ${INSTALL_ROOT}/usr/share/idl/mozilla           &&
#ln  -fns   ${INSTALL_ROOT}/usr/share/idl/mozilla           \
#           ${INSTALL_ROOT}/usr/share/idl/mozilla-$VERSION  &&
#mkdir  -p  ${INSTALL_ROOT}/usr/include/mozilla             &&
#ln  -fns   ${INSTALL_ROOT}/usr/include/mozilla             \
#           ${INSTALL_ROOT}/usr/include/mozilla-$VERSION    &&
ln  -fns    ${INSTALL_ROOT}/usr/share/idl/firefox-$VERSION  \
            ${INSTALL_ROOT}/usr/share/idl/firefox           &&
ln  -fns    ${INSTALL_ROOT}/usr/include/firefox-$VERSION    \
            ${INSTALL_ROOT}/usr/include/firefox             &&
make  install                                               &&
cp  -vaL  dist/public/nss                                   \
          ${INSTALL_ROOT}/usr/include/firefox-$VERSION/     &&
ln  -fns  ${FIREFOX_HOME}/firefox  /usr/bin/                &&

if  !  grep  -q  mozilla  /etc/ld.so.conf;  then
  echo  '/usr/lib/mozilla'  >>  /etc/ld.so.conf
fi  &&

#
# Create symlink to mozilla for hardwired applications
# Only create if /usr/bin/mozilla does not exist or is
# already a symlink
#
if  [  !  -f  /usr/bin/mozilla  -o  -h  /usr/bin/mozilla  ]
then
  ln  -sf  /usr/bin/firefox  /usr/bin/mozilla
fi  &&

#
# Fix for starting firefox without running as root first
# Bug #7114 (thanks to Florian Franzmann <siflfran@hawo.stw.uni-erlangen.de>
#
patch  -d  $FIREFOX_HOME-$VERSION  -p1  -N      \
       <  $SCRIPT_DIRECTORY/firefox-init.patch  &&

#
# Script to set MOZILLA_FIVE_HOME
#
cp  ${SCRIPT_DIRECTORY}/${SPELL}.sh  /etc/profile.d
