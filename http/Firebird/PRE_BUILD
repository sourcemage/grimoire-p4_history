if [ ! -f /root/.cvspass ]; then
  touch /root/.cvspass
fi                                                             &&
export FOO=Firebird_cvs.tar.bz2                                &&
mk_source_dir $SOURCE_DIRECTORY                                &&
if [ "$HEADCODE" = "yes" ] && [ -f $SOURCE_CACHE/$FOO ];
then message "${MESSAGE_COLOR}Unpacking source file ${SPELL_COLOR}$FOO \
${DEFAULT_COLOR}${MESSAGE_COLOR} for ${SPELL_COLOR}$SPELL"     &&
	tar jxf $SOURCE_CACHE/$FOO 
else unpack ${SOURCE} ${MD5[0]}
fi                                                             &&

#cvs updates anyone?
#

if [ "$HEADCODE" = "yes" ];
then message "\tIt can take some considerable time to regenerate the cvs tags,
\tyou will not see much progress for a time but do not despair 
\t\tGOOD THINGS are happening in the background." &&
cvs -z9 -q -d:pserver:anonymous@cvs-mirror.mozilla.org:/cvsroot checkout -PA -d mozilla mozilla/client.mk && 
cd $SOURCE_DIRECTORY                                           &&
make -j 1 -f client.mk checkout MOZ_CO_FLAGS=-PA MOZ_PHOENIX=1 &&
cd ../                                                         &&
message "${MESSAGE_COLOR}Generating tarball for next cast"     &&
tar jcf $FOO mozilla/                                          &&
message "${MESSAGE_COLOR}Moving $FOO to/var/spool/sorcery"     &&
mv -v $FOO $SOURCE_CACHE/                                      &&
echo -e "HEADCODE=yes\nSOURCE=$FOO\nCONFIGURED=yes" >> $SPELL_CONFIG
fi

